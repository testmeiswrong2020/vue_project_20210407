{"remainingRequest":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ME\\Documents\\vue_project_20210404\\src\\views\\CustomerOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\src\\views\\CustomerOrder.vue","mtime":1617381129379},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport $ from \"jquery\";\nexport default {\n  data: function data() {\n    return {\n      products: [],\n      product: {},\n      pagination: {},\n      isLoading: false,\n      status: {\n        loadingItem: \"\",\n        loadingItem_addToCart: \"\",\n        loadingItem_getCart: \"\"\n      },\n      cart: {},\n      coupon_code: \"\",\n      form: {\n        user: {\n          name: \"\",\n          email: \"\",\n          tel: \"\",\n          address: \"\"\n        },\n        message: \"\"\n      }\n    };\n  },\n  methods: {\n    /**\r\n     * 讀取資料\r\n     * */\n    getProducts: function getProducts() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/products?page=\").concat(page);\n      var vm = this;\n      vm.isLoading = true; //顯示loading\n\n      this.$http.get(api).then(function (response) {\n        console.log(response.data);\n        vm.products = response.data.products;\n        vm.isLoading = false; //隱藏loading\n\n        vm.pagination = response.data.pagination;\n      });\n    },\n    //取得單一 商品細節\n    getProduct: function getProduct(id) {\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/product/\").concat(id);\n      vm.status.loadingItem = id;\n      this.$http.get(url).then(function (response) {\n        // console.log(\"getProduct\", response.data);\n        vm.product = response.data.product;\n        $(\"#productModal\").modal(\"show\");\n        vm.status.loadingItem = \"\";\n      });\n    },\n    //\n    addToCart: function addToCart(product_id) {\n      var _this = this;\n\n      var qty = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      //qty =1代表未傳入qty的話就會預設傳1\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/cart\");\n      var cart = {\n        product_id: product_id,\n        qty: qty\n      };\n      vm.status.loadingItem_addToCart = product_id;\n      this.$http.post(url, {\n        data: cart\n      }).then(function (response) {\n        console.log(\"addToCart\", response.data);\n\n        _this.getCart();\n\n        vm.status.loadingItem_addToCart = \"\";\n        $(\"#productModal\").modal(\"hide\");\n      });\n    },\n    getCart: function getCart() {\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/cart\");\n      vm.isLoading = true;\n      this.$http.get(url).then(function (response) {\n        console.log(\"getCart\", response.data);\n        vm.cart = response.data.data;\n        vm.isLoading = false;\n      });\n    },\n    //移除購物車內容\n    removeCartItem: function removeCartItem(product_id) {\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/cart/\").concat(product_id);\n      vm.isLoading = true;\n      this.$http.delete(url).then(function (response) {\n        console.log(\"removeCartItem\", response.data);\n        vm.getCart();\n        vm.isLoading = false;\n      });\n    },\n    //新增優惠券\n    addCouponCode: function addCouponCode() {\n      var _this2 = this;\n\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/coupon\");\n      var coupon = {\n        code: vm.coupon_code\n      };\n      vm.isLoading = true;\n      this.$http.post(url, {\n        data: coupon\n      }).then(function (response) {\n        console.log(\"addCouponCode\", response.data);\n\n        if (response.data.success) {\n          vm.getCart();\n        } else {\n          _this2.$bus.$emit(\"message:push\", response.data.message, \"danger\");\n        }\n\n        vm.isLoading = false;\n      });\n    },\n    //\n    createOrder: function createOrder() {\n      var _this3 = this;\n\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/order\");\n      var order = vm.form;\n      vm.isLoading = true;\n      this.$http.post(url, {\n        data: order\n      }).then(function (response) {\n        console.log(\"createOrder\", response.data);\n\n        if (response.data.success) {\n          vm.$router.push(\"/customer_checkout/\".concat(response.data.orderId)); // this.getCart();\n          //  this.$bus.$emit(\"message:push\", response.data.message, \"success\");\n        } else {\n          _this3.$bus.$emit(\"message:push\", response.data.message, \"danger\");\n        }\n\n        vm.isLoading = false;\n      });\n    } //\n\n  },\n  //一進畫面要觸發的事件就放created內\n  created: function created() {\n    this.getProducts();\n    this.getCart();\n  }\n};",{"version":3,"sources":["CustomerOrder.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <loading :active.sync=\"isLoading\"></loading>\r\n    <div class=\"row mt-4\">\r\n      <div class=\"col-md-4 mb-4\" v-for=\"item in products\" :key=\"item.id\">\r\n        <div class=\"card border-0 shadow-sm\">\r\n          <div\r\n            style=\"\r\n              height: 150px;\r\n              background-size: cover;\r\n              background-position: center;\r\n            \"\r\n            :style=\"{ backgroundImage: `url(${item.imageUrl})` }\"\r\n          >\r\n            <!--ES6寫法插入圖片-->\r\n          </div>\r\n          <div class=\"card-body\">\r\n            <span class=\"badge badge-secondary float-right ml-2\">{{\r\n              item.category\r\n            }}</span>\r\n            <h5 class=\"card-title\">\r\n              <a href=\"#\" class=\"text-dark\">{{ item.title }}</a>\r\n            </h5>\r\n            <p class=\"card-text\">{{ item.content }}</p>\r\n            <div class=\"d-flex justify-content-between align-items-baseline\">\r\n              <div class=\"h5\" v-if=\"!item.price\">{{ item.origin_price }}</div>\r\n              <del class=\"h6\" v-if=\"item.price\">{{ item.origin_price }}</del>\r\n              <div class=\"h5\" v-if=\"item.price\">{{ item.price }}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"card-footer d-flex\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-outline-secondary btn-sm\"\r\n              @click=\"getProduct(item.id)\"\r\n            >\r\n              <i\r\n                class=\"fas fa-spinner fa-spin\"\r\n                v-if=\"status.loadingItem === item.id\"\r\n              ></i>\r\n              查看更多\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-outline-danger btn-sm ml-auto\"\r\n              @click=\"addToCart(item.id)\"\r\n            >\r\n              <i\r\n                class=\"fas fa-spinner fa-spin\"\r\n                v-if=\"status.loadingItem === item.id\"\r\n              ></i>\r\n              加到購物車\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!--pagination-start-->\r\n      <div class=\"col-md-12\">\r\n        <nav aria-label=\"...\">\r\n          <ul class=\"pagination\">\r\n            <li class=\"page-item\" :class=\"{ disabled: !pagination.has_pre }\">\r\n              <span\r\n                class=\"page-link\"\r\n                @click.prevent=\"getProducts(pagination.current_page - 1)\"\r\n                >Previous</span\r\n              >\r\n            </li>\r\n            <li\r\n              class=\"page-item\"\r\n              :class=\"{ active: pagination.current_page === page }\"\r\n              v-for=\"page in pagination.total_pages\"\r\n              :key=\"page\"\r\n            >\r\n              <a\r\n                class=\"page-link\"\r\n                href=\"#\"\r\n                @click.prevent=\"getProducts(page)\"\r\n                >{{ page }}</a\r\n              >\r\n            </li>\r\n            <li class=\"page-item\" :class=\"{ disabled: !pagination.has_next }\">\r\n              <a\r\n                class=\"page-link\"\r\n                href=\"#\"\r\n                @click.prevent=\"getProducts(pagination.current_page + 1)\"\r\n                >Next</a\r\n              >\r\n            </li>\r\n          </ul>\r\n        </nav>\r\n      </div>\r\n      <!--pagination-end-->\r\n    </div>\r\n    <!--cart-->\r\n    <div class=\"row\">\r\n      <div class=\"col-md-3\"></div>\r\n      <div class=\"col-md-6\">\r\n        <table class=\"table\">\r\n          <thead>\r\n            <th></th>\r\n            <th>品名</th>\r\n            <th>數量</th>\r\n            <th>單價</th>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\r\n              <td class=\"align-middle\">\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"btn btn-outline-danger btn-sm\"\r\n                  @click=\"removeCartItem(item.id)\"\r\n                >\r\n                  <i class=\"far fa-trash-alt\"></i>\r\n                </button>\r\n              </td>\r\n              <td class=\"align-middle\">\r\n                {{ item.product.title }}\r\n                <div class=\"text-success\" v-if=\"item.coupon\">已套用優惠券</div>\r\n              </td>\r\n              <td class=\"align-middle\">\r\n                {{ item.qty }}/{{ item.product.unit }}\r\n              </td>\r\n              <td class=\"align-middle text-right\">\r\n                {{ item.final_total | currency }}\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n          <tfoot>\r\n            <tr>\r\n              <td colspan=\"3\" class=\"text-right\">總計</td>\r\n              <td class=\"text-right\">{{ cart.total | currency }}</td>\r\n            </tr>\r\n            <tr v-if=\"cart.final_total != cart.total\">\r\n              <td colspan=\"3\" class=\"text-right text-success\">折扣價</td>\r\n              <td class=\"text-right text-success\">\r\n                {{ cart.final_total | currency }}\r\n              </td>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n        <div class=\"input-group mb-3 input-group-sm\">\r\n          <input\r\n            type=\"text\"\r\n            class=\"form-control\"\r\n            v-model=\"coupon_code\"\r\n            placeholder=\"請輸入優惠碼\"\r\n          />\r\n          <div class=\"input-group-append\">\r\n            <button\r\n              class=\"btn btn-outline-secondary\"\r\n              type=\"button\"\r\n              @click=\"addCouponCode\"\r\n            >\r\n              套用優惠碼\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!---form--start-->\r\n        <div class=\"mt-4\">\r\n          <validation-observer v-slot=\"{ invalid }\">\r\n            <form @submit.prevent=\"createOrder\" class=\"needs-validation\">\r\n              <validation-provider\r\n                rules=\"required|email\"\r\n                v-slot=\"{ errors, classes }\"\r\n              >\r\n                <div class=\"form-group\">\r\n                  <label for=\"useremail\">電子信箱</label>\r\n                  <input\r\n                    type=\"email\"\r\n                    class=\"form-control\"\r\n                    name=\"email\"\r\n                    id=\"useremail\"\r\n                    :class=\"classes\"\r\n                    v-model=\"form.user.email\"\r\n                    placeholder=\"請輸入 Email\"\r\n                    required\r\n                  />\r\n                  <span class=\"invalid-feedback\">{{ errors[0] }}</span>\r\n                </div>\r\n              </validation-provider>\r\n              <validation-provider\r\n                rules=\"required\"\r\n                v-slot=\"{ errors, classes }\"\r\n              >\r\n                <div class=\"form-group\">\r\n                  <label for=\"username\">收件人姓名</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    name=\"name\"\r\n                    id=\"username\"\r\n                    :class=\"classes\"\r\n                    v-model=\"form.user.name\"\r\n                    placeholder=\"輸入姓名\"\r\n                  />\r\n                  <span class=\"text-danger\">{{ errors[0] }}</span>\r\n                </div>\r\n              </validation-provider>\r\n              <validation-provider\r\n                rules=\"required\"\r\n                v-slot=\"{ errors, classes }\"\r\n              >\r\n                <div class=\"form-group\">\r\n                  <label for=\"usertel\">收件人電話</label>\r\n                  <input\r\n                    type=\"tel\"\r\n                    class=\"form-control\"\r\n                    id=\"usertel\"\r\n                    :class=\"classes\"\r\n                    v-model=\"form.user.tel\"\r\n                    placeholder=\"請輸入電話\"\r\n                  />\r\n                  <span class=\"text-danger\">{{ errors[0] }}</span>\r\n                </div>\r\n              </validation-provider>\r\n              <validation-provider\r\n                rules=\"required\"\r\n                v-slot=\"{ errors, classes }\"\r\n              >\r\n                <div class=\"form-group\">\r\n                  <label for=\"useraddress\">收件人地址</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    name=\"address\"\r\n                    :class=\"classes\"\r\n                    id=\"useraddress\"\r\n                    v-model=\"form.user.address\"\r\n                    placeholder=\"請輸入地址\"\r\n                  />\r\n                  <span class=\"text-danger\">{{ errors[0] }}</span>\r\n                </div>\r\n\r\n                <!--地址欄位不得留空-->\r\n              </validation-provider>\r\n          \r\n                <div class=\"form-group\">\r\n                  <label for=\"comment\">留言</label>\r\n                  <textarea\r\n                    id=\"comment\"\r\n                    class=\"form-control\"\r\n                    cols=\"30\"\r\n                    rows=\"10\"\r\n                    v-model=\"form.message\"\r\n                  ></textarea>\r\n                  <span class=\"text-danger\"></span>\r\n                </div>\r\n\r\n              <div class=\"text-right\">\r\n                <button class=\"btn btn-danger\" :disabled=\"invalid\">\r\n                  送出訂單\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </validation-observer>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-md-3\"></div>\r\n    </div>\r\n    <!---form--end-->\r\n\r\n    <!---product detail modal-->\r\n    <div\r\n      class=\"modal fade\"\r\n      id=\"productModal\"\r\n      tabindex=\"-1\"\r\n      role=\"dialog\"\r\n      aria-labelledby=\"exampleModalLabel\"\r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\r\n              {{ product.title }}\r\n            </h5>\r\n            <button\r\n              type=\"button\"\r\n              class=\"close\"\r\n              data-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n            >\r\n              <span aria-hidden=\"true\">&times;</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <img :src=\"product.imageUrl\" class=\"img-fluid\" alt=\"\" />\r\n            <blockquote class=\"blockquote mt-3\">\r\n              <p class=\"mb-0\">{{ product.content }}</p>\r\n              <footer class=\"blockquote-footer text-right\">\r\n                {{ product.description }}\r\n              </footer>\r\n            </blockquote>\r\n            <div class=\"d-flex justify-content-between align-items-baseline\">\r\n              <div class=\"h4\" v-if=\"!product.price\">\r\n                {{ product.origin_price }} 元\r\n              </div>\r\n              <del class=\"h6\" v-if=\"product.price\"\r\n                >原價 {{ product.origin_price }} 元</del\r\n              >\r\n              <div class=\"h4\" v-if=\"product.price\">\r\n                現在只要 {{ product.price }} 元\r\n              </div>\r\n            </div>\r\n            <select name=\"\" class=\"form-control mt-3\" v-model=\"product.num\">\r\n              <option :value=\"num\" v-for=\"num in 10\" :key=\"num\">\r\n                <!--num為此商品數量，unit為單位-->\r\n                選購 {{ num }} {{ product.unit }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <div class=\"text-muted text-nowrap mr-3\">\r\n              小計 <strong>{{ product.num * product.price }}</strong> 元\r\n            </div>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-primary\"\r\n              @click=\"addToCart(product.id, product.num)\"\r\n            >\r\n              <i\r\n                class=\"fas fa-spinner fa-spin\"\r\n                v-if=\"product.id === status.loadingItem\"\r\n              ></i>\r\n              加到購物車\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport $ from \"jquery\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      products: [],\r\n      product: {},\r\n      pagination: {},\r\n      isLoading: false,\r\n      status: {\r\n        loadingItem: \"\",\r\n        loadingItem_addToCart: \"\",\r\n        loadingItem_getCart: \"\",\r\n      },\r\n      cart: {},\r\n      coupon_code: \"\",\r\n      form: {\r\n        user: {\r\n          name: \"\",\r\n          email: \"\",\r\n          tel: \"\",\r\n          address: \"\",\r\n        },\r\n        message: \"\",\r\n      },\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    /**\r\n     * 讀取資料\r\n     * */\r\n    getProducts(page = 1) {\r\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/products?page=${page}`;\r\n      const vm = this;\r\n      vm.isLoading = true; //顯示loading\r\n      this.$http.get(api).then((response) => {\r\n        console.log(response.data);\r\n        vm.products = response.data.products;\r\n        vm.isLoading = false; //隱藏loading\r\n        vm.pagination = response.data.pagination;\r\n      });\r\n    },\r\n    //取得單一 商品細節\r\n    getProduct(id) {\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/product/${id}`;\r\n\r\n      vm.status.loadingItem = id;\r\n      this.$http.get(url).then((response) => {\r\n        // console.log(\"getProduct\", response.data);\r\n        vm.product = response.data.product;\r\n        $(\"#productModal\").modal(\"show\");\r\n        vm.status.loadingItem = \"\";\r\n      });\r\n    },\r\n    //\r\n    addToCart(product_id, qty = 1) {\r\n      //qty =1代表未傳入qty的話就會預設傳1\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart`;\r\n      const cart = {\r\n        product_id: product_id,\r\n        qty,\r\n      };\r\n      vm.status.loadingItem_addToCart = product_id;\r\n      this.$http.post(url, { data: cart }).then((response) => {\r\n        console.log(\"addToCart\", response.data);\r\n        this.getCart();\r\n        vm.status.loadingItem_addToCart = \"\";\r\n        $(\"#productModal\").modal(\"hide\");\r\n      });\r\n    },\r\n    getCart() {\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart`;\r\n      vm.isLoading = true;\r\n      this.$http.get(url).then((response) => {\r\n        console.log(\"getCart\", response.data);\r\n        vm.cart = response.data.data;\r\n        vm.isLoading = false;\r\n      });\r\n    },\r\n    //移除購物車內容\r\n    removeCartItem(product_id) {\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart/${product_id}`;\r\n      vm.isLoading = true;\r\n      this.$http.delete(url).then((response) => {\r\n        console.log(\"removeCartItem\", response.data);\r\n        vm.getCart();\r\n        vm.isLoading = false;\r\n      });\r\n    },\r\n    //新增優惠券\r\n    addCouponCode() {\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/coupon`;\r\n      const coupon = {\r\n        code: vm.coupon_code,\r\n      };\r\n      vm.isLoading = true;\r\n      this.$http.post(url, { data: coupon }).then((response) => {\r\n        console.log(\"addCouponCode\", response.data);\r\n        if (response.data.success) {\r\n          vm.getCart();\r\n        } else {\r\n          this.$bus.$emit(\"message:push\", response.data.message, \"danger\");\r\n        }\r\n        vm.isLoading = false;\r\n      });\r\n    },\r\n    //\r\n    createOrder() {\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/order`;\r\n      const order = vm.form;\r\n      vm.isLoading = true;\r\n      this.$http.post(url, { data: order }).then((response) => {\r\n        console.log(\"createOrder\", response.data);\r\n        if (response.data.success) {\r\n        vm.$router.push(`/customer_checkout/${response.data.orderId}`);\r\n          // this.getCart();\r\n          //  this.$bus.$emit(\"message:push\", response.data.message, \"success\");\r\n        } else {\r\n          this.$bus.$emit(\"message:push\", response.data.message, \"danger\");\r\n        }\r\n        vm.isLoading = false;\r\n      });\r\n    },\r\n    //\r\n  },\r\n  //一進畫面要觸發的事件就放created內\r\n  created() {\r\n    this.getProducts();\r\n    this.getCart();\r\n  },\r\n};\r\n</script>"],"sourceRoot":"src/views"}]}