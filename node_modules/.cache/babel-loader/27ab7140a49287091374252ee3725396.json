{"remainingRequest":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ME\\Documents\\vue_project_20210404\\src\\views\\AdminCoupons.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\src\\views\\AdminCoupons.vue","mtime":1617175985742},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ME\\Documents\\vue_project_20210404\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport $ from \"jquery\";\nexport default {\n  data: function data() {\n    return {\n      coupons: [],\n      isLoading: false,\n      isNew: false,\n      tempCoupon: {\n        title: \"\",\n        is_enabled: 0,\n        percent: 100,\n        due_date: 0,\n        code: \"\"\n      },\n      due_date: new Date(),\n      //預設值為當前時間\n      //此項用來改變 modal title\n      addOrUpdate: \"\",\n      pagination: {}\n    };\n  },\n  watch: {\n    due_date: function due_date() {\n      var vm = this;\n      var timestamp = Math.floor(new Date(vm.due_date) / 1000);\n      vm.tempCoupon.due_date = timestamp;\n    }\n  },\n  methods: {\n    getCoupon: function getCoupon() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var vm = this;\n      var url = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/coupons?page=\").concat(page);\n      vm.isLoading = true;\n      this.$http.get(url).then(function (response) {\n        console.log(\"getCoupon\", response.data);\n        vm.coupons = response.data.coupons;\n        vm.isLoading = false;\n      });\n    },\n    openCouponModal: function openCouponModal(isNew, item, isDel) {\n      var vm = this;\n\n      if (isDel) {\n        $(\"#delModal\").modal(\"show\");\n      } else {\n        $(\"#couponModal\").modal(\"show\");\n      }\n\n      if (isNew) {\n        //add\n        vm.tempCoupon = {};\n        vm.isNew = true;\n        vm.addOrUpdate = \"新增\";\n        var timestamp = Math.floor(new Date() / 1000);\n        var dateAndTime = new Date(timestamp * 1000).toISOString().split(\"T\");\n        vm.due_date = dateAndTime[0];\n      } else {\n        vm.tempCoupon = Object.assign({}, item);\n        vm.isNew = false;\n\n        if (!isDel) {\n          //update\n          vm.addOrUpdate = \"更新\";\n\n          var _dateAndTime = new Date(vm.tempCoupon.due_date * 1000).toISOString().split(\"T\");\n\n          vm.due_date = _dateAndTime[0];\n        } // console.log(\"werwe\", vm.tempCoupon.due_date + \"-----\" + dateAndTime[0]); //2021-03-29\n\n      }\n    },\n    updateCoupon: function updateCoupon() {\n      var _this = this;\n\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/coupon\");\n      var vm = this;\n      var httpMethod = \"post\"; //判斷要執行 add還是update api\n\n      if (!vm.isNew) {\n        //為update時\n        api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/coupon/\").concat(vm.tempCoupon.id);\n        httpMethod = \"put\";\n      }\n\n      vm.isLoading = true; //因為資料上送時是以物件形式，故 vm.tempCoupon 資料要用物件包起來\n\n      this.$http[httpMethod](api, {\n        data: vm.tempCoupon\n      }).then(function (response) {\n        console.log(\"updateCoupon\", response.data);\n\n        if (response.data.success) {\n          vm.getCoupon();\n        } else {\n          _this.$bus.$emit(\"message:push\", response.data.message, \"danger\");\n        }\n\n        vm.isLoading = false;\n        $(\"#couponModal\").modal(\"hide\");\n      });\n    },\n    delCoupon: function delCoupon() {\n      var _this2 = this;\n\n      var vm = this;\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMPATH, \"/admin/coupon/\").concat(vm.tempCoupon.id);\n      vm.isLoading = true;\n      this.$http.delete(api, {\n        data: vm.tempCoupon\n      }).then(function (response) {\n        console.log(\"delCoupon\", response.data);\n        vm.isLoading = false;\n        $(\"#delModal\").modal(\"hide\");\n\n        if (response.data.success) {\n          vm.getCoupon();\n        } else {\n          _this2.$bus.$emit(\"message:push\", response.data.message, \"danger\");\n        }\n      });\n    }\n  },\n  created: function created() {\n    this.getCoupon();\n  }\n};",{"version":3,"sources":["AdminCoupons.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"mt-4\">\r\n    <div class=\"text-right\">\r\n      <button\r\n        class=\"btn btn-primary\"\r\n        @click=\"openCouponModal(true, '', false)\"\r\n      >\r\n        建立新的優惠券\r\n      </button>\r\n    </div>\r\n    <table class=\"table mt-4\">\r\n      <thead>\r\n        <tr>\r\n          <th>名稱</th>\r\n          <th>折扣百分比</th>\r\n          <th>到期日</th>\r\n          <th>是否啟用</th>\r\n          <th>編輯</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"(item, key) in coupons\" :key=\"key\">\r\n          <td>{{ item.title }}</td>\r\n          <td>{{ item.percent }}%</td>\r\n          <td>{{ item.due_date | date }}</td>\r\n          <td>\r\n            <span v-if=\"item.is_enabled === 1\" class=\"text-success\">啟用</span>\r\n            <span v-else class=\"text-muted\">未啟用</span>\r\n          </td>\r\n          <td>\r\n            <div class=\"btn-group\" role=\"group\">\r\n              <button\r\n                class=\"btn btn-outline-primary btn-sm\"\r\n                @click=\"openCouponModal(false, item, false)\"\r\n              >\r\n                編輯\r\n              </button>\r\n              <button\r\n                class=\"btn btn-outline-danger btn-sm\"\r\n                @click=\"openCouponModal(false, item, true)\"\r\n              >\r\n                刪除\r\n              </button>\r\n            </div>\r\n            <!---->\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <!--delete modal start-->\r\n    <div\r\n      class=\"modal fade\"\r\n      id=\"delModal\"\r\n      tabindex=\"-1\"\r\n      role=\"dialog\"\r\n      aria-labelledby=\"delModalLabel\"\r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content border-0\">\r\n          <div class=\"modal-header bg-danger text-white\">\r\n            <h5 class=\"modal-title\" id=\"delModalLabel\">\r\n              <span>刪除優惠券</span>\r\n            </h5>\r\n            <button\r\n              type=\"button\"\r\n              class=\"close\"\r\n              data-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n            >\r\n              <span aria-hidden=\"true\">&times;</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            是否刪除\r\n            <strong class=\"text-danger\">{{ tempCoupon.title }}</strong>\r\n            優惠券(刪除後將無法恢復)。\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-outline-secondary\"\r\n              data-dismiss=\"modal\"\r\n            >\r\n              取消\r\n            </button>\r\n            <button type=\"button\" class=\"btn btn-danger\" @click=\"delCoupon\">\r\n              確認刪除\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!--delete modal end-->\r\n    <div\r\n      class=\"modal fade\"\r\n      id=\"couponModal\"\r\n      tabindex=\"-1\"\r\n      role=\"dialog\"\r\n      aria-labelledby=\"exampleModalLabel\"\r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\r\n              {{ addOrUpdate }}優惠券\r\n            </h5>\r\n            <button\r\n              type=\"button\"\r\n              class=\"close\"\r\n              data-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n            >\r\n              <span aria-hidden=\"true\">&times;</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"form-group\">\r\n              <label for=\"title\">標題</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"title\"\r\n                v-model=\"tempCoupon.title\"\r\n                placeholder=\"請輸入標題\"\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"coupon_code\">優惠碼</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"coupon_code\"\r\n                v-model=\"tempCoupon.code\"\r\n                placeholder=\"請輸入優惠碼\"\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"due_date\">到期日</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control\"\r\n                id=\"due_date\"\r\n                v-model=\"due_date\"\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"price\">折扣百分比</label>\r\n              <input\r\n                type=\"number\"\r\n                class=\"form-control\"\r\n                id=\"price\"\r\n                v-model=\"tempCoupon.percent\"\r\n                placeholder=\"請輸入折扣百分比\"\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <div class=\"form-check\">\r\n                <input\r\n                  class=\"form-check-input\"\r\n                  type=\"checkbox\"\r\n                  :true-value=\"1\"\r\n                  :false-value=\"0\"\r\n                  v-model=\"tempCoupon.is_enabled\"\r\n                  id=\"is_enabled\"\r\n                />\r\n                <label class=\"form-check-label\" for=\"is_enabled\">\r\n                  是否啟用\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-secondary\"\r\n              data-dismiss=\"modal\"\r\n            >\r\n              Close\r\n            </button>\r\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"updateCoupon\">\r\n              {{ addOrUpdate }}優惠券\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport $ from \"jquery\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      coupons: [],\r\n      isLoading: false,\r\n      isNew: false,\r\n      tempCoupon: {\r\n        title: \"\",\r\n        is_enabled: 0,\r\n        percent: 100,\r\n        due_date: 0,\r\n        code: \"\",\r\n      },\r\n      due_date: new Date(), //預設值為當前時間\r\n      //此項用來改變 modal title\r\n      addOrUpdate: \"\",\r\n      pagination: {},\r\n    };\r\n  },\r\n  watch: {\r\n    due_date() {\r\n      const vm = this;\r\n      const timestamp = Math.floor(new Date(vm.due_date) / 1000);\r\n      vm.tempCoupon.due_date = timestamp;\r\n    },\r\n  },\r\n  methods: {\r\n    getCoupon(page = 1) {\r\n      const vm = this;\r\n      const url = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/coupons?page=${page}`;\r\n      vm.isLoading = true;\r\n      this.$http.get(url).then((response) => {\r\n        console.log(\"getCoupon\", response.data);\r\n        vm.coupons = response.data.coupons;\r\n        vm.isLoading = false;\r\n      });\r\n    },\r\n    openCouponModal(isNew, item, isDel) {\r\n      const vm = this;\r\n      if (isDel) {\r\n        $(\"#delModal\").modal(\"show\");\r\n      } else {\r\n        $(\"#couponModal\").modal(\"show\");\r\n      }\r\n\r\n      if (isNew) {\r\n        //add\r\n        vm.tempCoupon = {};\r\n        vm.isNew = true;\r\n        vm.addOrUpdate = \"新增\";\r\n        const timestamp = Math.floor(new Date() / 1000);\r\n        const dateAndTime = new Date(timestamp * 1000).toISOString().split(\"T\");\r\n        vm.due_date = dateAndTime[0];\r\n      } else {\r\n        vm.tempCoupon = Object.assign({}, item);\r\n        vm.isNew = false;\r\n        if (!isDel) {\r\n          //update\r\n          vm.addOrUpdate = \"更新\";\r\n          const dateAndTime = new Date(vm.tempCoupon.due_date * 1000)\r\n            .toISOString()\r\n            .split(\"T\");\r\n          vm.due_date = dateAndTime[0];\r\n        }\r\n        // console.log(\"werwe\", vm.tempCoupon.due_date + \"-----\" + dateAndTime[0]); //2021-03-29\r\n      }\r\n    },\r\n    updateCoupon() {\r\n      let api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/coupon`;\r\n      const vm = this;\r\n      let httpMethod = \"post\";\r\n      //判斷要執行 add還是update api\r\n      if (!vm.isNew) {\r\n        //為update時\r\n        api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/coupon/${vm.tempCoupon.id}`;\r\n        httpMethod = \"put\";\r\n      }\r\n      vm.isLoading = true;\r\n      //因為資料上送時是以物件形式，故 vm.tempCoupon 資料要用物件包起來\r\n      this.$http[httpMethod](api, { data: vm.tempCoupon }).then((response) => {\r\n        console.log(\"updateCoupon\", response.data);\r\n        if (response.data.success) {\r\n          vm.getCoupon();\r\n        } else {\r\n          this.$bus.$emit(\"message:push\", response.data.message, \"danger\");\r\n        }\r\n        vm.isLoading = false;\r\n        $(\"#couponModal\").modal(\"hide\");\r\n      });\r\n    },\r\n    delCoupon() {\r\n      const vm = this;\r\n      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/admin/coupon/${vm.tempCoupon.id}`;\r\n      vm.isLoading = true;\r\n      this.$http.delete(api, { data: vm.tempCoupon }).then((response) => {\r\n        console.log(\"delCoupon\", response.data);\r\n        vm.isLoading = false;\r\n        $(\"#delModal\").modal(\"hide\");\r\n        if (response.data.success) {\r\n          vm.getCoupon();\r\n        } else {\r\n          this.$bus.$emit(\"message:push\", response.data.message, \"danger\");\r\n        }\r\n      });\r\n    },\r\n  },\r\n  created() {\r\n    this.getCoupon();\r\n  },\r\n};\r\n</script>\r\n"],"sourceRoot":"src/views"}]}